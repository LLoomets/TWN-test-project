import{a as G}from"./chunk-R3AGSL2Y.js";import"./chunk-WQKB2RLF.js";import{j,k as H,l as U,m as q}from"./chunk-W652DE4C.js";import{$a as f,B as E,Fa as V,Ja as P,Qa as d,Ra as A,S as L,Sa as F,Ta as B,Ua as $,Va as o,Wa as a,Xa as _,Y as g,Z as u,_a as y,ab as l,fb as N,gb as p,hb as b,ia as S,ib as R,ob as z,sa as D,ta as T,va as r,x as O}from"./chunk-E6IAYWFM.js";function Y(s,e){if(s&1&&(o(0,"tr",10)(1,"td",11)(2,"div",12),_(3,"img",13)(4,"div",14),a()()()),s&2){let t=l().$implicit;r(3),d("src",t.image.large,T),r(),d("innerHTML",t.body.slice(0,300)+(t.body.length>300?"\u2026":""),D)}}function Z(s,e){if(s&1){let t=y();o(0,"tr",8),f("click",function(){let n=g(t).$index,c=l(2);return u(c.toggleExpand(n))}),o(1,"td")(2,"span"),p(3),a()(),o(4,"td")(5,"span"),p(6),a()(),o(7,"td")(8,"span"),p(9),a()(),o(10,"td")(11,"span"),p(12),a()(),o(13,"td")(14,"span"),p(15),a()()(),P(16,Y,5,2,"tr",9)}if(s&2){let t=e.$implicit,i=e.$index,n=l(2);r(3),b(t.firstname),r(3),b(t.surname),r(3),b(n.getSexLabel(t.sex)),r(3),b(n.getBirthDateFromId(t.personal_code)),r(3),b(t.phone),r(),d("ngIf",n.expandedRow===i)}}function tt(s,e){if(s&1){let t=y();o(0,"table")(1,"thead")(2,"tr")(3,"th")(4,"button",6),f("click",function(){g(t);let n=l();return u(n.sortBy("firstname"))}),p(5," Eesnimi "),_(6,"i",7),a()(),o(7,"th")(8,"button",6),f("click",function(){g(t);let n=l();return u(n.sortBy("surname"))}),p(9," Perekonnanimi "),_(10,"i",7),a()(),o(11,"th")(12,"button",6),f("click",function(){g(t);let n=l();return u(n.sortBy("sex"))}),p(13," Sugu "),_(14,"i",7),a()(),o(15,"th")(16,"button",6),f("click",function(){g(t);let n=l();return u(n.sortBy("personal_code"))}),p(17," S\xFCnnikuup\xE4ev "),_(18,"i",7),a()(),o(19,"th"),p(20,"Telefon"),a()()(),o(21,"tbody"),B(22,Z,17,6,null,null,F),a()()}if(s&2){let t=l();r(6),d("ngClass",t.getSortIcon("firstname")),r(4),d("ngClass",t.getSortIcon("surname")),r(4),d("ngClass",t.getSortIcon("sex")),r(4),d("ngClass",t.getSortIcon("personal_code")),r(4),$(t.paginatedList)}}function et(s,e){if(s&1){let t=y();o(0,"button",20),f("click",function(){let n=g(t).$implicit,c=l(2);return u(c.changePage(n))}),p(1),a()}if(s&2){let t=e.$implicit,i=l(2);A("active",i.currentPage()===t),r(),R(" ",t," ")}}function nt(s,e){if(s&1){let t=y();o(0,"div",15)(1,"button",16),f("click",function(){g(t);let n=l();return u(n.currentPage.set(n.currentPage()-1))}),_(2,"i",17),a(),P(3,et,2,3,"button",18),o(4,"button",16),f("click",function(){g(t);let n=l();return u(n.changePage(n.currentPage()+1))}),_(5,"i",19),a()()}if(s&2){let t=l();r(),d("disabled",t.currentPage()===1),r(2),d("ngForOf",t.visiblePages()),r(),d("disabled",t.currentPage()===t.totalPages)}}function it(s,e){s&1&&(o(0,"div",21),_(1,"img",22),a())}var J=class s{articleService=L(G);articleItems=S([]);originalData=[];loading=S(!0);sortField=null;sortDirection="default";expandedRow=null;currentPage=S(1);rowsPerPage=10;ngOnInit(){this.articleService.getArticleList().pipe(O(e=>{throw console.log(e),e}),E(()=>this.loading.set(!1))).subscribe(e=>{this.articleItems.set(e),this.originalData=e})}sortBy(e){if(this.sortField!==e?(this.sortField=e,this.sortDirection="asc"):this.sortDirection=this.sortDirection==="asc"?"desc":this.sortDirection==="desc"?"default":"asc",this.sortDirection==="default"){this.articleItems.set(this.originalData),this.sortField=null;return}let t=[...this.articleItems()].sort((i,n)=>{if(e==="sex"){let C={f:0,m:1},w=C[i.sex]??2,v=C[n.sex]??2;return this.sortDirection==="asc"?w-v:v-w}if(e==="personal_code"){let C=K=>{let k=String(K),h=k.charAt(0),I="";h==="1"||h==="2"?I="18":h==="3"||h==="4"?I="19":(h==="5"||h==="6")&&(I="20");let Q=parseInt(I+k.substring(1,3)),W=parseInt(k.substring(3,5)),X=parseInt(k.substring(5,7));return new Date(Q,W,X)},w=C(i.personal_code),v=C(n.personal_code);return this.sortDirection==="asc"?w.getTime()-v.getTime():v.getTime()-w.getTime()}let c=(i[e]??"").toString().toLowerCase(),m=(n[e]??"").toString().toLowerCase(),x=!c||c.trim()==="",M=!m||m.trim()==="";return x&&!M?1:!x&&M?-1:c<m?this.sortDirection==="asc"?-1:1:c>m?this.sortDirection==="asc"?1:-1:0});this.articleItems.set(t)}getSexLabel(e){return e==="m"?"Mees":e==="f"?"Naine":""}getBirthDateFromId(e){let t=String(e),i=t.charAt(0),n="";i==="1"||i==="2"?n="18":i==="3"||i==="4"?n="19":(i==="5"||i==="6")&&(n="20");let c=n+t.substring(1,3),m=t.substring(3,5);return`${t.substring(5,7)}.${m}.${c}`}getSortIcon(e){return this.sortField!==e?"fa-solid fa-sort":this.sortDirection==="asc"?"fa-solid fa-sort-down":this.sortDirection==="desc"?"fa-solid fa-sort-up":"fa-solid fa-sort"}toggleExpand(e){this.expandedRow===e?this.expandedRow=null:this.expandedRow=e}get paginatedList(){let e=(this.currentPage()-1)*this.rowsPerPage,t=e+this.rowsPerPage;return this.articleItems().slice(e,t)}get totalPages(){return Math.ceil(this.articleItems().length/this.rowsPerPage)}changePage(e){this.currentPage.set(e),this.expandedRow=null}visiblePages(){let e=this.currentPage(),t=this.totalPages,i=5,n=Math.max(1,e-Math.floor(i/2)),c=n+i-1;c>t&&(c=t,n=Math.max(1,c-i+1));let m=[];for(let x=n;x<=c;x++)m.push(x);return m}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=V({type:s,selectors:[["app-list"]],decls:9,vars:3,consts:[["loadingBlock",""],[1,"page-container"],[1,"page-layout"],[1,"table-wrapper"],[4,"ngIf","ngIfElse"],["class","pagination",4,"ngIf"],[1,"sort-btn",3,"click"],[3,"ngClass"],[1,"clickable-row",3,"click"],["class","expanded-row",4,"ngIf"],[1,"expanded-row"],["colspan","5"],[1,"list-details"],["alt","article.image-alt",1,"list-image",3,"src"],[1,"list-body",3,"innerHTML"],[1,"pagination"],[3,"click","disabled"],[1,"fa-solid","fa-chevron-left"],[3,"active","click",4,"ngFor","ngForOf"],[1,"fa-solid","fa-chevron-right"],[3,"click"],[1,"loading-wrapper"],["src","imgs/loader.svg","alt","Loading...",1,"loader-img"]],template:function(t,i){if(t&1&&(o(0,"div",1)(1,"div",2)(2,"h1"),p(3,"Nimekiri"),a(),o(4,"div",3),P(5,tt,24,4,"table",4),a(),P(6,nt,6,3,"div",5)(7,it,2,0,"ng-template",null,0,z),a()()),t&2){let n=N(8);r(5),d("ngIf",i.paginatedList.length>0)("ngIfElse",n),r(),d("ngIf",i.paginatedList.length>0)}},dependencies:[q,j,H,U],styles:[".table-wrapper[_ngcontent-%COMP%]{width:100%;overflow-x:auto}table[_ngcontent-%COMP%]{min-width:100%;border-collapse:collapse;table-layout:fixed}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{width:20%;padding:10px 16px;border-bottom:1px solid #fff;overflow:hidden;white-space:nowrap}th[_ngcontent-%COMP%]{background-color:#333;color:#fff;text-align:left}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#ffffff1a}.sort-btn[_ngcontent-%COMP%]{background:none;border:none;padding:0;margin:0;font:inherit;cursor:pointer;color:inherit}.list-image[_ngcontent-%COMP%]{width:200px;height:200px;object-fit:cover;margin:6px;flex-shrink:0;background-color:#f1f1f1}.expanded-row[_ngcontent-%COMP%]{background-color:#fff!important;color:#333!important}.expanded-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{max-width:100%;overflow:hidden;white-space:normal}.list-details[_ngcontent-%COMP%]{display:flex}.list-body[_ngcontent-%COMP%]{padding-left:1rem}.clickable-row[_ngcontent-%COMP%]{cursor:pointer}.pagination[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin-top:1rem}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:40px;height:40px;font-size:1rem;border-radius:50%;background-color:transparent;border:1px solid transparent;color:#fff;cursor:pointer;font-weight:700;padding:0;margin:.5rem}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border-color:#fff}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#fff;color:#333}@media (max-width: 960px){th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:14px;padding:6px 8px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:2rem;height:2rem}}"]})};export{J as ListComponent};
